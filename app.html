<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Lapor Mangan! - Temukan kuliner UMKM terbaik di Purwokerto">
    <meta name="theme-color" content="#FF6B35">
    <title>Lapor Mangan! - Kuliner Purwokerto</title>
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    
    <link rel="stylesheet" href="app-complete.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-brand">
            <h1>Lapor Mangan!</h1>
            <span class="header-location"><i class="fas fa-map-marker-alt"></i> Purwokerto</span>
        </div>
        <div class="header-actions">
            <div id="weatherWidget" class="weather-widget" onclick="getWeatherRecommendation()">
                <span class="weather-icon">‚òÄÔ∏è</span>
                <span class="weather-temp">--¬∞C</span>
            </div>
            <div id="authBtn"></div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <button class="nav-item active" data-page="home" onclick="navigate('home')">
            <i class="fas fa-home"></i>
            <span>Beranda</span>
        </button>
        <button class="nav-item" data-page="berita" onclick="navigate('berita')">
            <i class="fas fa-newspaper"></i>
            <span>Berita</span>
        </button>
        <button class="nav-item" data-page="promo" onclick="navigate('promo')">
            <i class="fas fa-tags"></i>
            <span>Promo</span>
        </button>
        <button class="nav-item" data-page="favorit" onclick="navigate('favorit')">
            <i class="fas fa-heart"></i>
            <span>Favorit</span>
        </button>
        <button class="nav-item" data-page="admin" id="adminNav" style="display:none" onclick="navigate('admin')">
            <i class="fas fa-cog"></i>
            <span>Admin</span>
        </button>
    </nav>

    <!-- Page: Home -->
    <main id="page-home" class="page active">
        <!-- Map -->
        <section class="map-section">
            <div id="map"></div>
        </section>

        <!-- Search & Filters -->
        <section class="filter-section">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Cari kuliner...">
            </div>
            
            <div class="quick-filters">
                <button class="qf-btn" onclick="applyFilters()">Semua</button>
                <button class="qf-btn" onclick="sortByDistance()"><i class="fas fa-location-arrow"></i> Terdekat</button>
                <button class="qf-btn" onclick="filterOpenNow()"><i class="fas fa-clock"></i> Buka</button>
                <button class="qf-btn" onclick="showRandom()"><i class="fas fa-random"></i> Acak</button>
                <button class="qf-btn" onclick="getWeatherRecommendation()"><i class="fas fa-cloud-sun"></i> Cuaca</button>
            </div>
            
            <div class="filter-row">
                <select id="categoryFilter"><option value="">Kategori</option></select>
                <select id="typeFilter">
                    <option value="">Tipe</option>
                    <option value="tetap">üè† Tetap</option>
                    <option value="keliling">üõµ Keliling</option>
                </select>
                <select id="halalFilter">
                    <option value="">Halal</option>
                    <option value="halal">‚úÖ Halal MUI</option>
                    <option value="halal-self">üïå Halal</option>
                    <option value="unknown">‚ùì Belum Diketahui</option>
                </select>
                <select id="sortFilter">
                    <option value="">Urutkan</option>
                    <option value="nama">A-Z</option>
                    <option value="rating">‚≠ê Rating</option>
                    <option value="harga-asc">üí∞ Termurah</option>
                    <option value="harga-desc">üí∞ Termahal</option>
                </select>
            </div>
            
            <label class="checkbox-filter">
                <input type="checkbox" id="openNowFilter">
                <span>Hanya tampilkan yang buka sekarang</span>
            </label>
        </section>

        <!-- Map -->
        <section class="map-section">
            <div id="map"></div>
        </section>
        <!-- Kuliner List -->
        <section class="list-section">
            <div class="section-header">
                <h2>Kuliner Populer</h2>
                <button class="btn btn-sm" onclick="showSubmitForm()">+ Tambah</button>
            </div>
            <div id="kulinerList" class="kuliner-grid"></div>
        </section>
    </main>

    <!-- Page: Berita -->
    <main id="page-berita" class="page">
        <div class="page-header">
            <h2>Berita & Artikel</h2>
            <p>Tips, event, dan liputan kuliner Purwokerto</p>
        </div>
        <div id="beritaList" class="berita-grid"></div>
    </main>

    <!-- Page: Promo -->
    <main id="page-promo" class="page">
        <div class="page-header">
            <h2>Promo & Diskon</h2>
            <p>Jangan lewatkan penawaran spesial!</p>
        </div>
        <div id="promoList" class="promo-grid"></div>
    </main>

    <!-- Page: Favorit -->
    <main id="page-favorit" class="page">
        <div class="page-header">
            <h2>Favorit Saya</h2>
            <p>Kuliner yang kamu simpan</p>
        </div>
        <div id="favoritList" class="kuliner-grid"></div>
    </main>

    <!-- Page: Admin -->
    <main id="page-admin" class="page">
        <div class="page-header">
            <h2>Panel Admin</h2>
            <p>Kelola data kuliner, berita, dan promo</p>
        </div>
        <div id="adminContent"></div>
    </main>

    <!-- Modal: Detail -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- Modal: Login -->
    <div class="modal" id="loginModal">
        <div class="modal-content modal-sm">
            <button class="modal-close" onclick="closeLoginModal()"><i class="fas fa-times"></i></button>
            <div class="login-content">
                <h2>Login</h2>
                <p>Masuk untuk menyimpan favorit, memberikan ulasan, dan menambahkan kuliner baru.</p>
                <button class="btn btn-google" onclick="loginWithGoogle()">
                    <i class="fab fa-google"></i> Login dengan Google
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Submit Kuliner -->
    <div class="modal" id="submitModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeSubmitModal()"><i class="fas fa-times"></i></button>
            <div class="submit-content">
                <h2>Tambah Kuliner Baru</h2>
                <p>Kontribusikan informasi kuliner UMKM Purwokerto</p>
                <form id="submitForm" onsubmit="submitKuliner(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nama Kuliner *</label>
                            <input type="text" id="subNama" required>
                        </div>
                        <div class="form-group">
                            <label>Kategori *</label>
                            <input type="text" id="subKategori" placeholder="Soto, Sate, Jajanan..." required>
                        </div>
                        <div class="form-group full">
                            <label>Alamat *</label>
                            <input type="text" id="subAlamat" required>
                        </div>
                        <div class="form-group">
                            <label>Jam Operasional *</label>
                            <input type="text" id="subJam" placeholder="08:00 - 21:00" required>
                        </div>
                        <div class="form-group">
                            <label>Kisaran Harga *</label>
                            <input type="text" id="subHarga" placeholder="Rp10.000 - Rp20.000" required>
                        </div>
                        <div class="form-group full">
                            <label>Deskripsi</label>
                            <textarea id="subDeskripsi" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label>URL Foto</label>
                            <input type="url" id="subFoto" placeholder="https://...">
                        </div>
                        <div class="form-group">
                            <label>Kontak (WA)</label>
                            <input type="tel" id="subKontak" placeholder="08123456789">
                        </div>
                        <div class="form-group">
                            <label>Latitude</label>
                            <input type="number" step="any" id="subLat" placeholder="-7.4212">
                        </div>
                        <div class="form-group">
                            <label>Longitude</label>
                            <input type="number" step="any" id="subLng" placeholder="109.2422">
                        </div>
                        <div class="form-group">
                            <label>Status Halal</label>
                            <select id="subHalal">
                                <option value="unknown">Belum Diketahui</option>
                                <option value="halal">Halal MUI</option>
                                <option value="halal-self">Halal (Self-Declared)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Parkir</label>
                            <input type="text" id="subParkir" placeholder="Tersedia / Tidak">
                        </div>
                        <div class="form-group">
                            <label>Rute/Lokasi</label>
                            <input type="text" id="subRute">
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="subKeliling">
                                <span>Penjual Keliling</span>
                            </label>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Kirim untuk Moderasi</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Chat Button -->
    <button class="chat-fab" onclick="toggleChat()">
        <i class="fas fa-comments"></i>
    </button>

    <!-- Chat Panel -->
    <div class="chat-panel" id="chatPanel">
        <div class="chat-header">
            <span><i class="fas fa-robot"></i> MakanBot</span>
            <button onclick="toggleChat()"><i class="fas fa-times"></i></button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="chat-msg bot">Halo! Saya MakanBot ü§ñ Mau cari kuliner apa hari ini?</div>
        </div>
        <div class="chat-input">
            <input type="text" id="chatInput" placeholder="Ketik pesan..." onkeypress="handleChatKey(event)">
            <button onclick="sendChat()"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app-complete.js"></script>
</body>
</html>
